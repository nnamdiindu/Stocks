{% extends "auth/layouts/auth-base.html" %}
{% block title %}Email Sent{% endblock %}
{% block content %}

<h1 class="mb-2 fw-bold text-center" style="font-size: 2rem; color: #212529;">Check your email</h1>
<p class="text-muted mb-3 text-center" style="font-size: 0.95rem;">We sent a verification link to:</p>
<p class="email">{{ email }}</p>

<div id="message"></div>

<p style="font-size: 14px; color: #999;">
    Click the link in the email to verify your account and get started.
</p>

<div class="divider"></div>

<!-- Resend Email Link -->
<div class="text-center">
    <p style="font-size: 14px;">Didn't receive the email?</p>
    <button onclick="resendEmail()" class="btn btn-primary w-100 mb-3 fw-semibold" id="resendBtn">
        Resend Verification Email
    </button>
</div>
</div>
</div>
<script>
    async function resendEmail() {
        const btn = document.getElementById('resendBtn');
        const message = document.getElementById('message');

        btn.disabled = true;
        btn.textContent = 'Sending...';

        try {
            const response = await fetch('resend-verification', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email: '{{ email }}' })
            });

            const data = await response.json();

            if (response.ok) {
                message.className = 'success';
                message.textContent = 'Email sent! Check your inbox.';
            } else {
                message.className = 'error';
                message.textContent = data.error || 'Failed to send email';
            }
        } catch (error) {
            message.className = 'error';
            message.textContent = 'Something went wrong. Please try again.';
        } finally {
            btn.disabled = false;
            btn.textContent = 'Resend Verification Email';
        }
    }
</script>
{% endblock %}